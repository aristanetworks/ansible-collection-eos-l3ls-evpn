
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Arista Validated Design collection's documentation">
      
      
        <meta name="author" content="Arista Ansible Team">
      
      
      
        <link rel="prev" href="../release-notes/1.0.x.html">
      
      
        <link rel="next" href="../getting-started.html">
      
      <link rel="icon" href="../_media/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.0.15">
    
    
      
        <title>Introduction to Ansible and AVD - Arista AVD collection</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.material.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#table-of-contents" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Arista AVD collection" class="md-header__button md-logo" aria-label="Arista AVD collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arista AVD collection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction to Ansible and AVD
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aristanetworks/ansible-avd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    AVD on Github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Arista AVD collection" class="md-nav__button md-logo" aria-label="Arista AVD collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>

    </a>
    Arista AVD collection
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aristanetworks/ansible-avd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    AVD on Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/3.x.x.html" class="md-nav__link">
        3.x.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.x.x.html" class="md-nav__link">
        2.x.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/1.1.x.html" class="md-nav__link">
        1.1.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/1.0.x.html" class="md-nav__link">
        1.0.x
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Introduction to Ansible and AVD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="intro-to-ansible-and-avd.html" class="md-nav__link md-nav__link--active">
        Introduction to Ansible and AVD
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avd-and-ansible-overview" class="md-nav__link">
    AVD and Ansible Overview
  </a>
  
    <nav class="md-nav" aria-label="AVD and Ansible Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#day-1-operation-ie-provisioning-a-network-from-scratch" class="md-nav__link">
    Day 1 Operation (i.e. provisioning a network from scratch)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-ansible" class="md-nav__link">
    What is Ansible?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-are-the-requirements-to-run-ansible" class="md-nav__link">
    What are the requirements to run Ansible?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-the-aristaavd-collection" class="md-nav__link">
    What is the arista.avd collection?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-and-when-not-to-use-avd" class="md-nav__link">
    When and when not to use AVD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-your-mindset-and-culture" class="md-nav__link">
    Change your mindset and culture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-does-ansible-work" class="md-nav__link">
    How does Ansible work?
  </a>
  
    <nav class="md-nav" aria-label="How does Ansible work?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inventories" class="md-nav__link">
    Inventories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#organizing-host-and-group-variables" class="md-nav__link">
    Organizing host and group variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-variables" class="md-nav__link">
    Group Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playbooks" class="md-nav__link">
    Playbooks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-of-truth" class="md-nav__link">
    Source of Truth
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-use-avd" class="md-nav__link">
    How do I use AVD?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-2-operations" class="md-nav__link">
    Day 2 Operations
  </a>
  
    <nav class="md-nav" aria-label="Day 2 Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#day-2-operations-example" class="md-nav__link">
    Day 2 Operations Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started.html" class="md-nav__link">
        First steps with AVD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/collection-installation.html" class="md-nav__link">
        Collection Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/requirements.html" class="md-nav__link">
        Requirements
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          How-To
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          How-To
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/first-project.html" class="md-nav__link">
        Build your first AVD project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/first-cvp-avd-project.html" class="md-nav__link">
        Build your first AVD & CVP project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/lab-with-nat.html" class="md-nav__link">
        Use NAT to access eAPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/tower-integration.html" class="md-nav__link">
        AWX & Tower Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/ztp.html" class="md-nav__link">
        Configure ZTP server with CV collection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/vscode-container.html" class="md-nav__link">
        VScode Container
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Roles documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Roles documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          eos_designs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          eos_designs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/connected-endpoints.html" class="md-nav__link">
        Connected Endpoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/l3-edge.html" class="md-nav__link">
        DCI & L3 Edge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/fabric-topology.html" class="md-nav__link">
        Fabric Topology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/fabric-variables.html" class="md-nav__link">
        Fabric Variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/management-settings.html" class="md-nav__link">
        Management Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/network-services.html" class="md-nav__link">
        Network Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/node-types.html" class="md-nav__link">
        Node types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/platform-settings.html" class="md-nav__link">
        Platform Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/custom-structured-configuration.html" class="md-nav__link">
        Custom Structured Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" >
      
      
      
        <label class="md-nav__link" for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
          MPLS Design (BETA)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1_11">
          <span class="md-nav__icon md-icon"></span>
          MPLS Design (BETA)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/fabric-topology-mpls-BETA.html" class="md-nav__link">
        Fabric Topology MPLS (BETA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/fabric-variables-mpls-BETA.html" class="md-nav__link">
        Fabric Variables MPLS (BETA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/core-interfaces-BETA.html" class="md-nav__link">
        Core Interfaces (BETA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/network-services-mpls-BETA.html" class="md-nav__link">
        Network Services MPLS (BETA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/connected-endpoints-mpls-BETA.html" class="md-nav__link">
        Connected Endpoints MPLS (BETA)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_cli_config_gen/index.html" class="md-nav__link">
        eos_cli_config_gen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/cvp_configlet_upload/index.html" class="md-nav__link">
        cvp_configlet_upload
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_config_deploy_cvp/index.html" class="md-nav__link">
        eos_config_deploy_cvp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_config_deploy_eapi/index.html" class="md-nav__link">
        eos_config_deploy_eapi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_validate_state/index.html" class="md-nav__link">
        eos_validate_state
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_snapshot/index.html" class="md-nav__link">
        eos_snapshot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/dhcp_provisioner/index.html" class="md-nav__link">
        dhcp_provisioner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/build_output_folders/index.html" class="md-nav__link">
        build_output_folders
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Modules documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Modules documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/inventory_to_container.rst.html" class="md-nav__link">
        Module Inventory to containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/configlet_build_config.rst.html" class="md-nav__link">
        Module Configlet Build configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/index.html" class="md-nav__link">
        AVD Plugins & Filters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://cvp.avd.sh/" class="md-nav__link">
        Cloudvision Module documentation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Contributing to AVD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Contributing to AVD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/setup-environment.html" class="md-nav__link">
        Setup environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/setup-git.html" class="md-nav__link">
        Git installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/getting-started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/style-guide.html" class="md-nav__link">
        Code Style
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/development.html" class="md-nav__link">
        Development tips & tricks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          External resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          External resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html" class="md-nav__link">
        Ansible collection user guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.ansible.com/ansible/latest/user_guide/index.html" class="md-nav__link">
        Ansible User guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://galaxy.ansible.com/arista/avd" class="md-nav__link">
        Ansible Galaxy page
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://cvp.avd.sh/en/latest/" class="md-nav__link">
        Arista CVP Collection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/arista-netdevops-community/avd-install" class="md-nav__link">
        Arista Installation Script
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://aristanetworks.github.io/netdevops-examples/" class="md-nav__link">
        Arista Netdevops Community
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avd-and-ansible-overview" class="md-nav__link">
    AVD and Ansible Overview
  </a>
  
    <nav class="md-nav" aria-label="AVD and Ansible Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#day-1-operation-ie-provisioning-a-network-from-scratch" class="md-nav__link">
    Day 1 Operation (i.e. provisioning a network from scratch)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-ansible" class="md-nav__link">
    What is Ansible?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-are-the-requirements-to-run-ansible" class="md-nav__link">
    What are the requirements to run Ansible?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-the-aristaavd-collection" class="md-nav__link">
    What is the arista.avd collection?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-and-when-not-to-use-avd" class="md-nav__link">
    When and when not to use AVD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-your-mindset-and-culture" class="md-nav__link">
    Change your mindset and culture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-does-ansible-work" class="md-nav__link">
    How does Ansible work?
  </a>
  
    <nav class="md-nav" aria-label="How does Ansible work?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inventories" class="md-nav__link">
    Inventories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#organizing-host-and-group-variables" class="md-nav__link">
    Organizing host and group variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-variables" class="md-nav__link">
    Group Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playbooks" class="md-nav__link">
    Playbooks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-of-truth" class="md-nav__link">
    Source of Truth
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-use-avd" class="md-nav__link">
    How do I use AVD?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#day-2-operations" class="md-nav__link">
    Day 2 Operations
  </a>
  
    <nav class="md-nav" aria-label="Day 2 Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#day-2-operations-example" class="md-nav__link">
    Day 2 Operations Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Introduction to Ansible and AVD</h1>

<h3 id="table-of-contents">Table of Contents <!-- omit in toc --><a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="#avd-and-ansible-overview">AVD and Ansible Overview</a><ul>
<li><a href="#day-1-operation-ie-provisioning-a-network-from-scratch">Day 1 Operation (i.e. provisioning a network from scratch)</a></li>
<li><a href="#what-is-ansible">What is Ansible?</a></li>
<li><a href="#what-are-the-requirements-to-run-ansible">What are the requirements to run Ansible?</a></li>
<li><a href="#what-is-the-aristaavd-collection">What is the arista.avd collection?</a></li>
<li><a href="#when-and-when-not-to-use-avd">When and when not to use AVD</a></li>
<li><a href="#change-your-mindset-and-culture">Change your mindset and culture</a></li>
<li><a href="#how-does-ansible-work">How does Ansible work?</a><ul>
<li><a href="#inventories">Inventories</a></li>
<li><a href="#organizing-host-and-group-variables">Organizing host and group variables</a></li>
<li><a href="#group-variables">Group Variables</a></li>
<li><a href="#playbooks">Playbooks</a></li>
</ul>
</li>
<li><a href="#source-of-truth">Source of Truth</a></li>
<li><a href="#how-do-i-use-avd">How do I use AVD?</a></li>
<li><a href="#day-2-operations">Day 2 Operations</a><ul>
<li><a href="#day-2-operations-example">Day 2 Operations Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
</li>
</ul>
<h3 id="avd-and-ansible-overview">AVD and Ansible Overview<a class="headerlink" href="#avd-and-ansible-overview" title="Permanent link">&para;</a></h3>
<h4 id="day-1-operation-ie-provisioning-a-network-from-scratch">Day 1 Operation (i.e. provisioning a network from scratch)<a class="headerlink" href="#day-1-operation-ie-provisioning-a-network-from-scratch" title="Permanent link">&para;</a></h4>
<p>Imagine being asked to configure a layer 3 leaf spine (L3LS) network from scratch:</p>
<p><img alt="Figure: Arista Leaf Spine topology" src="../_media/getting-started/LS-Topology.png" /></p>
<p>Traditionally one would configure the switches manually using a laptop, console cable and USB key to load the correct EOS software
image and configuration. Of course the configuration would be manually generated too, using snippets from the relevant Arista
design guides, or copying/pasting from existing devices. Configurations would have to be manually adapted to each and every device,
which is time-consuming and very likely to lead to errors. Also consider what would happen if a new pair of leaf switches or new
VRFs/VLANs are added to the network - changes would need to be made to most of the devices in the network.</p>
<p>Using Arista Validated Designs (AVD), this task is automated, greatly simplified and made considerably faster. All the basic
network configuration is guaranteed to be identical across the entire fabric from day one. No longer do you have to manually
inspect each and every device for errors or differences; AVD will ensure the consistency and accuracy of your configuration not
only for initial deployment, but for all subsequent network changes.</p>
<p>AVD is also based on best practice from
<a href="https://www.arista.com/en/solutions/design-guides">Arista Design and Deployment Guides</a>, meaning you get the full benefit of
Arista&rsquo;s experience in deploying large scale leaf spine fabrics. AVD also fully integrates with Arista CloudVision, which adds
a full change control workflow, continuous compliance check and network topology overview as well as real time streaming telemetry
including flow-based data and more.</p>
<h4 id="what-is-ansible">What is Ansible?<a class="headerlink" href="#what-is-ansible" title="Permanent link">&para;</a></h4>
<p>The Red Hat® Ansible® Automation Platform is an open source tool, released in 2012 and acquired by Red Hat in 2015. Ansible
is an automation engine that can be used for many purposes including:</p>
<ul>
<li>Server software provisioning</li>
<li>Configuration management</li>
<li>Application deployment</li>
</ul>
<p>It is easily extended through the use of Ansible Collections - essentially prepackaged groups of Ansible components such as
playbooks,roles, modules and plugins - that are distributed through <a href="https://galaxy.ansible.com/home">Ansible Galaxy</a>.</p>
<p>Between the core Ansible software and third-party-contributed collections, Ansible can be used to carry out almost any
automated task on network, server or cloud platforms in a consistent, secure and and distributed way.</p>
<p>Consistency of tasks carried out is assured through the idea of idempotency - that the outcome of an operation is only
performed once and only if necessary, no matter how many times that operation is carried out. A very simple example of
idempotency would be a pair of on/off buttons for a machine - no matter how many times you push &lsquo;on&rsquo;, the machine will
only turn on once.</p>
<p>Unlike other tools, Ansible doesn&rsquo;t make use of a proprietary communications mechanism or agent on the device being managed.
Instead it leverages industry-standard protocols for device access including SSH and REST APIs. This also means that
Ansible doesn&rsquo;t require setup of any special infrastructure - it&rsquo;s entirely possible to automate tasks using nothing but
your laptop or desktop computer (but a central deployment server is recommended).</p>
<p>Tasks in Ansible are described in a structured language known as <a href="https://yaml.org">YAML</a>. Unlike other languages such as
JSON and XML, YAML was designed to be human-readable. YAML will be covered further later on in the section
<a href="#how-does-ansible-work">How does Ansible work</a>.</p>
<p>By now you can probably appreciate that Ansible can be used to automate many things. In this document, we will only focus
on using Ansible to provision Arista EOS devices either with or without Arista CloudVision.</p>
<h4 id="what-are-the-requirements-to-run-ansible">What are the requirements to run Ansible?<a class="headerlink" href="#what-are-the-requirements-to-run-ansible" title="Permanent link">&para;</a></h4>
<p>Ansible can run on almost anything, but in production scenarios Ansible is typically deployed on a virtual Linux server,
running on the customer&rsquo;s preferred hypervisor. This Ansible server then communicates either directly with the
Arista network devices via eAPI or with Arista CloudVision Portal, which in turn communicates with the Arista network devices.
Controlling what Ansible does is typically done using an SSH terminal session to the Ansible server from the Operator&rsquo;s computer.</p>
<p><img alt="Figure: Ansible and CVP" src="../_media/getting-started/Ansible-and-CVP-httpapi.png" /></p>
<h4 id="what-is-the-aristaavd-collection">What is the arista.avd collection?<a class="headerlink" href="#what-is-the-aristaavd-collection" title="Permanent link">&para;</a></h4>
<p><a href="https://galaxy.ansible.com/arista/avd">Arista.avd</a> is an Ansible collection for Arista Validated Designs. It is maintained by
Arista and accepts third-party contributions on GitHub at <a href="https://github.com/aristanetworks/ansible-avd">aristanetworks/ansible-avd</a>.</p>
<p>While Ansible is the core automation engine, AVD is an Ansible Collection as described above. It provides roles, modules and plugins
that allow the user to generate and deploy best-practice configurations to a layer 3 leaf spine network.</p>
<p><img alt="Figure: Arista Leaf Spine topology" src="../_media/getting-started/Ansible-AVD.png" /></p>
<p>In the illustration above, the AVD collection is shown as the box with the red background on the right hand side.</p>
<p>When designing an EVPN/VXLAN layer 3 leaf spine (L3LS) fabric you don&rsquo;t need to spend hours reading through the
<a href="https://www.arista.com/en/solutions/design-guides">Arista Design and Deployment Guides</a>. All those rules and guidelines are
implemented as part of the AVD collection.</p>
<p>AVD is an opinionated collection, meaning that field experiences and best practices from actual deployments at Arista customers
are included. With AVD, users get up and running quickly without having to invent every part of the network configuration
from scratch. This means only the most basic information must be provided by the user to get a new fabric up and running.</p>
<p>Parameters which need to be defined by the user include (but are not limited to):</p>
<ul>
<li>Username/password for network devices and CloudVision</li>
<li>OOB management IP range</li>
<li>IP scope for link addresses</li>
<li>IP scope for loopback interfaces</li>
<li>VLAN and VNI ranges</li>
<li>Device hostnames</li>
<li>Autonomous System numbers</li>
<li>Interface connections between devices</li>
<li>Which devices are acting in each role, such as spine or leaf.</li>
</ul>
<p>From the details provided above, AVD will generate complete EOS configuration files that can be deployed to the devices.
AVD also uses the information provided to produce complete documentation of the current intended state of the network.</p>
<h4 id="when-and-when-not-to-use-avd">When and when not to use AVD<a class="headerlink" href="#when-and-when-not-to-use-avd" title="Permanent link">&para;</a></h4>
<p>It&rsquo;s important to note when and perhaps more importantly when not to use AVD.</p>
<p>AVD is designed to generate and deploy complete configuration files in a manner where the network device&rsquo;s running-configuration is
completely replaced. As such, caution should be exercised when running AVD against an existing manually-configured network. Various
approaches can be taken under such circumstances:</p>
<ul>
<li>Compare AVD-generated configurations against device running-configurations; make changes to the AVD input data and iterate
  until the configurations are functionally equivalent.</li>
<li>Use AVD to generate partial configurations that can be applied to devices in such a way that they will not destroy existing
  manual configuration.</li>
<li>Use AVD to generate configurations part-based on automation, part-based on manual configuration included into AVD using AVD&rsquo;s
  <code>structured_configuration</code>, <code>raw_eos_cli</code> or <code>custom_template</code> facilities.</li>
</ul>
<p>Automating provisioning of network infrastructure makes most sense when the network is built from repeatable building blocks.
These allow for code reuse and abstraction of data. For example in most leaf spine networks, point-to-point links are
allocated IP subnets from a much larger pool. This is a tedious job for a human to design and configure, but is an ideal
candidate to be automated. However in a network that has evolved rather than been designed from the ground up, automation
may take longer to achieve.</p>
<h4 id="change-your-mindset-and-culture">Change your mindset and culture<a class="headerlink" href="#change-your-mindset-and-culture" title="Permanent link">&para;</a></h4>
<p>Many network engineers prefer to use the CLI for all things networking, like troubleshooting, ad-hoc operational configuration changes
and full blown greenfield provisioning tasks.</p>
<p>To harvest the full benefit of Ansible and Ansible AVD,
you must learn to think differently and change your ways of working.</p>
<p>Ansible should be your first choice when changing your network configuration,
be it small or big. The CLI should only be used for troubleshooting i.e. viewing the state of your network,
or those urgent scenarios at 2am where you need to change something very specific on just one or two devices
followed by proper configuration cleanup later.</p>
<h4 id="how-does-ansible-work">How does Ansible work?<a class="headerlink" href="#how-does-ansible-work" title="Permanent link">&para;</a></h4>
<p>Before we can tell Ansible to do anything, Ansible needs to know about the devices (or as Ansible calls them, hosts) in your network.</p>
<p>This is defined in the Ansible <strong><em>inventory</em></strong>. Per the official Ansible documentation the <a href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#inventory-basics-formats-hosts-and-groups">inventory</a>
is a file typically in either INI or YAML format, but other inventory sources can be used. In Ansible AVD we use YAML format by default,
hence the file is called inventory.yml, located in a folder that is also called inventory:</p>
<p><img alt="Figure: Ansible Inventory Folder Structure" src="../_media/getting-started/Inventory-folder-structure.png" /></p>
<p>Please note that the example above is taken from the <a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo">ansible-avd-cloudvision-demo</a> repository.</p>
<p>The exact name of the inventory file is not important, but is provided to Ansible in the <code>ansible.cfg</code> file for the project
or as <code>ansible-playbook -i ./inventory.yml</code> when later running Ansible.</p>
<h5 id="inventories">Inventories<a class="headerlink" href="#inventories" title="Permanent link">&para;</a></h5>
<p>An example of a snippet of the inventory.yml file is shown below (subset of an actual file for clarity).</p>
<p>As stated earlier this file is in <a href="https://yaml.org">YAML</a> format.</p>
<p>Also note that the IP addresses shown below are only an example of the management IP addresses for the different devices.
These can of course be adapted to fit any topology.</p>
<div class="highlight"><pre><span></span><code><span class="nt">all</span><span class="p">:</span>
<span class="w">  </span><span class="nt">children</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># DC1_Fabric - EVPN Fabric</span>
<span class="w">    </span><span class="nt">DC1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<span class="w">        </span><span class="nt">DC1_FABRIC</span><span class="p">:</span>
<span class="w">          </span><span class="nt">children</span><span class="p">:</span>
<span class="w">            </span><span class="nt">DC1_SPINES</span><span class="p">:</span>
<span class="w">              </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">                </span><span class="nt">DC1-SPINE1</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.11</span>
<span class="w">                </span><span class="nt">DC1-SPINE2</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.12</span>
<span class="w">            </span><span class="nt">DC1_L3LEAFS</span><span class="p">:</span>
<span class="w">              </span><span class="nt">children</span><span class="p">:</span>
<span class="w">                </span><span class="nt">DC1_LEAF1</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">DC1-LEAF1A</span><span class="p">:</span>
<span class="w">                      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.13</span>
<span class="w">                    </span><span class="nt">DC1-LEAF1B</span><span class="p">:</span>
<span class="w">                      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.14</span>
<span class="w">                </span><span class="nt">DC1_LEAF2</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">DC1-LEAF2A</span><span class="p">:</span>
<span class="w">                      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.15</span>
<span class="w">                    </span><span class="nt">DC1-LEAF2B</span><span class="p">:</span>
<span class="w">                      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.16</span>
</code></pre></div>
<p>Don&rsquo;t confuse <strong><em>hosts</em></strong> with servers or similar. A host can be anything that can be accessed via SSH or an API, to be managed by Ansible,
including Arista switches.</p>
<p>The settings inside the inventory.yml file are defined in a tree-like structure using <strong><em>groups</em></strong>. Groups can contain hosts or other groups -
making it easier to apply common configuration to a group of devices.</p>
<p>The <strong><em>all</em></strong> line at the top is a default group that contains all <strong><em>hosts</em></strong> i.e. all switches. Don&rsquo;t worry too much about that for now.</p>
<p>The <strong><em>children:</em></strong> keyword is used to define &ldquo;groups of groups&rdquo; i.e. just an internal keyword to differentiate between hosts and groups.</p>
<p>The multi-colored figure below is just a visualization of the same text file, showing the different grouping and parent/child relationships:</p>
<p><img alt="Figure: Ansible Inventory" src="../_media/getting-started/Inventory.png" /></p>
<p>The key takeaway is that configuration defined at a higher (parent) level will be inherited by the children, but if needed, this can be
overridden by specifying it again, i.e. most specific wins.</p>
<p>More information about Ansible inventories can be found <a href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#">here</a>.</p>
<h5 id="organizing-host-and-group-variables">Organizing host and group variables<a class="headerlink" href="#organizing-host-and-group-variables" title="Permanent link">&para;</a></h5>
<p>AVD makes use of variables defined in the inventory to generate the EOS configuration files necessary to configure the devices. While these
variables can be stored in the main inventory file described earlier, it is highly recommended to use separate files for host and group
variables. Like the inventory.yml file, the host and group variables are also stored in YAML files in dedicated folders named accordingly.</p>
<h5 id="group-variables">Group Variables<a class="headerlink" href="#group-variables" title="Permanent link">&para;</a></h5>
<p>Group variables are defined in YAML files inside the <code>group_vars</code> folder:</p>
<p><img alt="Figure: Ansible Group Variables" src="../_media/getting-started/Group-vars-folder-structure.png" /></p>
<p>Please note that the example above is taken from the <a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo">ansible-avd-cloudvision-demo</a> repository.</p>
<p>Each file in the <code>group_vars</code> folder controls the variables for one of the groups defined in the <code>inventory.yml</code> file,
so settings for the whole network can be specified in <code>DC1.yml</code>, and later overridden in <code>DC1_SPINES.yml</code> for just the hosts
inside that group (DC1 spine switches in this case).</p>
<p>A subset of DC1.yml is shown below:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># local users</span>
<span class="nt">local_users</span><span class="p">:</span>
<span class="w">  </span><span class="nt">admin</span><span class="p">:</span>
<span class="w">    </span><span class="nt">privilege</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="w">    </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-admin</span>
<span class="w">    </span><span class="nt">sha512_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;password-hash&gt;&quot;</span>

<span class="w">  </span><span class="nt">cvpadmin</span><span class="p">:</span>
<span class="w">    </span><span class="nt">privilege</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="w">    </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-admin</span>
<span class="w">    </span><span class="nt">sha512_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;password-hash&gt;&quot;</span>

<span class="w">  </span><span class="nt">ansible</span><span class="p">:</span>
<span class="w">    </span><span class="nt">privilege</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
<span class="w">    </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-admin</span>
<span class="w">    </span><span class="nt">sha512_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;password-hash&gt;&quot;</span>

<span class="c1"># Cloud Vision server information</span>
<span class="nt">cvp_instance_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;CVP IP address&gt;</span>
<span class="nt">cvp_ingestauth_key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&lt;key&gt;&#39;</span>

<span class="c1"># OOB Management network default gateway.</span>
<span class="nt">mgmt_gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;IP of default gateway&gt;</span>

<span class="c1"># dns servers.</span>
<span class="nt">name_servers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;IP of name server</span><span class="w"> </span><span class="c1">#1&gt;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;IP of name server</span><span class="w"> </span><span class="c1">#2&gt;</span>
</code></pre></div>
<p>Below is a subset of the DC1_FABRIC file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">l3leaf</span><span class="p">:</span>
<span class="w">  </span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># virtual router mac for VNIs assigned to Leaf switches</span>
<span class="w">    </span><span class="c1"># format: xx:xx:xx:xx:xx:xx</span>
<span class="w">    </span><span class="nt">virtual_router_mac_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">00:1c:73:00:dc:01</span>
<span class="w">    </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vEOS-LAB</span>
<span class="w">    </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65100</span>
<span class="w">    </span><span class="nt">spines</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">DC1-SPINE1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">DC1-SPINE2</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">uplink_to_spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Ethernet1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">mlag_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Ethernet3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">spanning_tree_priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">409</span>
<span class="w">    </span><span class="nt">spanning_tree_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mstp</span>
<span class="w">  </span><span class="nt">node_groups</span><span class="p">:</span>
<span class="w">    </span><span class="nt">DC1_LEAF1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65101</span>
<span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<span class="w">        </span><span class="nt">DC1-LEAF1A</span><span class="p">:</span>
<span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.13/24</span>
<span class="w">          </span><span class="nt">spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Ethernet1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet1</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">DC1-LEAF1B</span><span class="p">:</span>
<span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.14/24</span>
<span class="w">          </span><span class="nt">spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Ethernet2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">DC1_LEAF2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65102</span>
<span class="w">      </span><span class="nt">nodes</span><span class="p">:</span>
<span class="w">        </span><span class="nt">DC1-LEAF2A</span><span class="p">:</span>
<span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.15/24</span>
<span class="w">          </span><span class="nt">spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Ethernet3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet3</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">DC1-LEAF2B</span><span class="p">:</span>
<span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.16/24</span>
<span class="w">          </span><span class="nt">spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Ethernet4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet4</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>The above snippet defines a number of defaults that apply to all children of DC1_FABRIC along with configuration specific to
each leaf pair and finally each individual leaf switch.</p>
<p>Group variables can be overridden by specifying host variables for specific devices.
(See <a href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-hash-behaviour">DEFAULT_HASH_BEHAVIOUR</a>).
The order of precedence is (from lowest to highest):</p>
<ul>
<li>&lsquo;All&rsquo; group (because it is the &lsquo;parent&rsquo; of all other groups)</li>
<li>Parent group</li>
<li>Child group</li>
<li>Host</li>
</ul>
<p>You can read more about group and host variables <a href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#id14">here</a>.</p>
<h5 id="playbooks">Playbooks<a class="headerlink" href="#playbooks" title="Permanent link">&para;</a></h5>
<p>Now that the Ansible inventory is defined, we can tell Ansible what to do on the switches.
This is defined in one or more Ansible <strong><em>playbooks</em></strong>.</p>
<p>A playbook, like an inventory file, is a text file written using YAML format and it contains one or more <strong><em>plays</em></strong>.</p>
<p>Each play is configured to run on a particular host or group of hosts and contains one or more <strong><em>tasks</em></strong>.</p>
<p>Each task calls an Ansible <strong><em>role</em></strong> or <strong><em>module</em></strong>, such as <strong><em>ansible.avd.eos_cli_config_gen</em></strong>. The tasks in
conjunction with the roles or modules they are calling are responsible for performing a particular task or set of tasks.</p>
<p>A playbook runs in order from top to bottom. Within each play, tasks also run in order from top to bottom.</p>
<p>Playbooks with multiple plays can orchestrate multi-machine deployments, running one play on your Ansible development machine,
another on your CloudVision instance, and another on each EOS device you look to configure.</p>
<p>At a minimum, each play defines two things:
1. The managed devices (<strong><em>hosts</em></strong>) to target, referenced from the <strong><em>inventory</em></strong> we defined earlier
2. One or more <strong><em>tasks</em></strong> to execute on the targets defined</p>
<p>The hosts specified in a playbook typically reference groups defined in the inventory. From a playbook you can select
large or small groups of the inventory, right down to individual hosts to be as specific as possible with any configuration changes.</p>
<p>A simple example of a play defined in a playbook is shown below:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Play to build EOS configuration from EOS_DESIGNS</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DC1_FABRIC</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># BUILD EOS configuration</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generate intended variables</span>
<span class="w">      </span><span class="nt">import_role</span><span class="p">:</span>
<span class="w">         </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arista.avd.eos_designs</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generate device intended config and documentation</span>
<span class="w">      </span><span class="nt">import_role</span><span class="p">:</span>
<span class="w">         </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arista.avd.eos_cli_config_gen</span>
</code></pre></div>
<p>At the top of the file, the <strong><em>hosts</em></strong> keyword references the inventory group <strong><em>DC1_FABRIC</em></strong>.</p>
<p>Recall that the group variables are defined in the inventory.yml file and further in the group_vars directory.
Effectively this means that the <strong><em>hosts</em></strong> keyword defines the scope of devices on which to execute the play.</p>
<p>Following the scope definition, the <strong><em>tasks</em></strong> are then defined.</p>
<p>In this example the play executes two tasks:
1. Import a <strong><em>role</em></strong> called <a href="https://avd.sh/en/latest/roles/eos_designs/index.html"><strong><em>arista.avd.eos_designs</em></strong></a>
2. Import a <strong><em>role</em></strong> called <a href="https://avd.sh/en/latest/roles/eos_cli_config_gen/index.html"><strong><em>arista.avd.eos_cli_config_gen</em></strong></a></p>
<p>The <strong><em>arista.avd.eos_designs</em></strong> role takes inputs from a number of <a href="https://avd.sh/en/latest/roles/eos_designs/index.html#role-inputs-and-outputs">places</a>:
- role/defaults definitions
- group_vars
- host_vars</p>
<p>Based on some or all of these inputs, it generates the following output:
- A structured EOS configuration in YAML format
- Fabric Documentation in Markdown format
- Leaf and Spine Topology summary in CSV format</p>
<p>The second role, <strong><em>arista.avd.eos_cli_config_gen</em></strong> uses the structured EOS configuration in YAML format as its <a href="https://avd.sh/en/latest/roles/eos_cli_config_gen/index.html#role-inputs-and-outputs">input</a>
(generated by arista.avd.eos_designs) and outputs the following:
- EOS configuration in CLI format
- Device Documentation in Markdown format</p>
<p>Running the play described above would result in a number of files containing the configuration and documentation for the devices in scope - in this case DC1_FABRIC.
To apply the configuration to the actual devices, you would run additional roles such as:
- <a href="https://avd.sh/en/latest/roles/eos_config_deploy_cvp/index.html">eos_config_deploy_cvp</a> which deploys the EOS configuration via the
  CloudVision Management platform, including change control with RBAC and full rollback capability.
- <a href="https://avd.sh/en/latest/roles/eos_config_deploy_eapi/index.html">eos_config_deploy_eapi</a> which deploys the EOS configuration directly
  to Arista devices using config replace. This option provides no change control and no rollback capability.</p>
<p>While this play shows both the <code>eos_designs</code> and <code>eos_cli_config_gen</code> roles used together, it is entirely possible to make use of just
<code>eos_cli_config_gen</code> by itself - this would allow (for example) generation of management configuration that could potentially be merged
into an existing network as discussed earlier.</p>
<h4 id="source-of-truth">Source of Truth<a class="headerlink" href="#source-of-truth" title="Permanent link">&para;</a></h4>
<p>In a legacy network where configuration is not administered centrally, you have very little control of the relationship between the configuration
you <em>intend</em> to be applied to the network, and the configuration actually <em>running</em> on the network. You might have centralized low level design
documents describing in great detail how exactly the network should function, but you don&rsquo;t have much but best intentions to ensure that your
<strong>entire</strong> network is working as you intended. It takes only a single configuration mistake on a single device to create havoc.</p>
<p>Since operating many networking devices also typically result in having many networking engineers, there is even more room for error.
Different people do things differently and repetitive tasks are not always executed in the exact same manner.</p>
<p>With AVD, you define not only the topology of your network centrally, but also which services are used where in a central repository
of text files. Because this data is stored in text files, it is possible to apply version control (for example using tools like git, subversion
or mercurial) to this source of truth, giving you visibility of when the intended configuration was changed and by who.</p>
<p>This source of truth means you have a full overview of your entire designed network configuration without having to look at individual network devices.
An additional benefit of AVD is that by design you always have a backup of your network configuration including automated documentation in markdown format,
No longer do you have to remember to update documentation about which interface is connected to which device etc.,
whenever you change something on a device. It&rsquo;s all done automatically based on the configuration built and applied to the network devices by Ansible,
every time you execute the playbooks.</p>
<p>Below you will find two examples of documentation automatically created by Ansible AVD:</p>
<ul>
<li><a href="../../molecule/eos_designs-twodc-5stage-clos/documentation/fabric/TWODC_5STAGE_CLOS-documentation.html">5 stage CLOS fabric across two Data Centers</a></li>
<li><a href="../../molecule/eos_designs-twodc-5stage-clos/documentation/devices/DC1-POD1-L2LEAF1A.html">A single leaf inside the fabric above</a></li>
</ul>
<h4 id="how-do-i-use-avd">How do I use AVD?<a class="headerlink" href="#how-do-i-use-avd" title="Permanent link">&para;</a></h4>
<p>AVD comes with pre-built templates that you can either use as-is or adapt to your liking. For example
<a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo">ansible-avd-cloudvision-demo</a> is a 3-stage leaf spine fabric
that can be deployed CloudVision.</p>
<p>Once the templates reflect your desired network configuration, you deploy the configuration either directly to the Arista EOS devices or to
Configlets within CloudVision. This is typically executed from the CLI - for example:</p>
<div class="highlight"><pre><span></span><code>ansible-playbook<span class="w"> </span>playbooks/dc1-fabric-deploy-cvp.yml<span class="w"> </span>--tags<span class="w"> </span>build
</code></pre></div>
<p>This will execute the playbook <code>playbooks/dc1-fabric-deploy-cvp.yml</code> with the tag <code>build</code>. This instructs Ansible to only run the tasks tagged &lsquo;build&rsquo;
in the playbook - which in this case will result in configuration files being generated but not deployed to devices.</p>
<p>To push the configuration to devices using CloudVision:</p>
<div class="highlight"><pre><span></span><code>ansible-playbook<span class="w"> </span>playbooks/dc1-fabric-deploy-cvp.yml<span class="w"> </span>--tags<span class="w"> </span>provision
</code></pre></div>
<p>This will:
- Create a CloudVision Configlet for each device in the inventory, containing the device&rsquo;s entire configuration.
- Build out containers within CloudVision that represent the hierarchy of groups represented in the inventory.
- Create tasks to apply the new configuration to each device within the inventory.</p>
<p>At this point the changes can be reviewed, approved and executed in accordance with existing company requirements through CloudVision.</p>
<p>The equivalent workflow is also possible with eAPI - albeit without the review and approval stages provided through CloudVision.</p>
<p>Once the configuration has been deployed, an automated validation of the designed configuration versus the running configuration can be executed using the included <code>eos_validate_state</code> role, to ensure that:</p>
<ul>
<li>All links are operational and cabled as desired</li>
<li>BGP adjacencies are operational</li>
<li>That there are no device hardware issues (for example PSU or fan issues)</li>
<li>That VTEPs can all reach each other using their loopback IPs.</li>
</ul>
<p>This quickly identifies any issues that could otherwise be overlooked and a redundant link could sit non-operational for months unless cumbersome manual testing is executed again per-device throughout the fabric.</p>
<h4 id="day-2-operations">Day 2 Operations<a class="headerlink" href="#day-2-operations" title="Permanent link">&para;</a></h4>
<p>The term day 2 operations describes most, if not all network configuration changes that occur after the initial configuration.</p>
<p>These tasks, while relatively simple, can be time consuming simply because they involve changes to many device:</p>
<ul>
<li>Adding/removing new leaf switches</li>
<li>Adding/removing new VLANs</li>
<li>Creating/modifying/deleting port profiles</li>
<li>Configuring/modifying ports towards end systems</li>
</ul>
<p>Making these changes could involve many hours of planning to generate configuration snippets to apply during a change window.</p>
<p>Alternatively a configuration change can easily be applied to the YAML inventory/group_vars files - for example this change could
create a new VLAN and deploy this VLAN to a subset of switches.</p>
<p>Once the inventory files have been updated, the playbooks can be run again to generate new configuration files that will replace the
configuration files running on the devices in exactly the same way as the initial configuration.</p>
<h5 id="day-2-operations-example">Day 2 Operations Example<a class="headerlink" href="#day-2-operations-example" title="Permanent link">&para;</a></h5>
<p>Let&rsquo;s imagine that you want to create a new tenant in your existing fabric.
This would require at least the following configuration:</p>
<ul>
<li>VRF(s)</li>
<li>VLAN(s)</li>
<li>SVI(s)</li>
</ul>
<p>You could create a YAML file, in this example called DC1_TENANTS_NETWORKS.yml, describing the fabric-wide generic configuration for the tenant:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># DC1 Tenants Networks</span>
<span class="c1"># Documentation of Tenant specific information - Vlans/VRFs</span>
<span class="nt">tenants</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Tenant A Specific Information - VRFs / VLANs</span>
<span class="w">  </span><span class="nt">Tenant_A</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mac_vrf_vni_base</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">    </span><span class="nt">vrfs</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Tenant_A_OP_Zone</span><span class="p">:</span>
<span class="w">        </span><span class="nt">vrf_vni</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">        </span><span class="nt">vtep_diagnostic</span><span class="p">:</span>
<span class="w">          </span><span class="nt">loopback</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">          </span><span class="nt">loopback_ip_range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.1.0/24</span>
<span class="w">        </span><span class="nt">svis</span><span class="p">:</span>
<span class="w">          </span><span class="nt">110</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tenant_A_OP_Zone_1</span>
<span class="w">            </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">opzone</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.10.1/24</span>
<span class="w">          </span><span class="nt">111</span><span class="p">:</span>
<span class="w">            </span><span class="nt">vni_override</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50111</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tenant_A_OP_Zone_2</span>
<span class="w">            </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">opzone</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.11.1/24</span>
<span class="w">          </span><span class="nt">112</span><span class="p">:</span>
<span class="w">            </span><span class="nt">vni_override</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50112</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tenant_A_OP_Zone_3</span>
<span class="w">            </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">opzone</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">            </span><span class="nt">ip_address_virtual</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.12.254/24</span>
</code></pre></div>
<p>You would then describe the scope for where this new tenant should exist in the inventory.yml file:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">node_groups</span><span class="p">:</span>
<span class="w">    </span><span class="nt">DC1-P101-L2LS1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tenants</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Tenant_A</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">opzone</span><span class="w"> </span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>This specifies that switch DC1-P101-L2LS1 will only be configured with VLANs/SVIs in Tenant_A that are tagged with &lsquo;opzone&rsquo;.</p>
<p>For sake of simplicity, let&rsquo;s say you defined just one pair of leaf switches that would serve this tenant.</p>
<p>After running the relevant playbook, their tenant-related configuration would end up looking like this:</p>
<div class="highlight"><pre><span></span><code>vlan 110
   name Tenant_A_OP_Zone_1
!
vlan 111
   name Tenant_A_OP_Zone_2
!
vlan 112
   name Tenant_A_OP_Zone_3
!
vrf instance Tenant_A_OP_Zone
!
interface Loopback100
   description Tenant_A_OP_Zone_VTEP_DIAGNOSTICS
   no shutdown
   vrf Tenant_A_OP_Zone
   ip address 10.255.1.3/32
!
interface Vlan110
   description Tenant_A_OP_Zone_1
   no shutdown
   vrf Tenant_A_OP_Zone
   ip address virtual 10.1.10.1/24
!
interface Vlan111
   description Tenant_A_OP_Zone_2
   no shutdown
   vrf Tenant_A_OP_Zone
   ip address virtual 10.1.11.1/24
!
interface Vlan112
   description Tenant_A_OP_Zone_3
   no shutdown
   vrf Tenant_A_OP_Zone
   ip address virtual 10.1.12.254/24
!
interface Vxlan1
   vxlan vlan 110 vni 10110
   vxlan vlan 111 vni 50111
   vxlan vlan 112 vni 50112
   vxlan vrf Tenant_A_OP_Zone vni 10
</code></pre></div>
<p>If at a later date this tenant needs to be made available on other devices in the network simply expanding the scope of the devices where Tenant_A exists.
This would result in similar configuration being generated for those devices as well.</p>
<p>This all takes place without any manual intervention and with very little chance for human error.</p>
<h4 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h4>
<p>Below are a number of links to additional documentation about Ansible AVD and Ansible in general:</p>
<ul>
<li>With <a href="../../roles/eos_cli_config_gen">eos_design</a></li>
<li>With <a href="../../roles/eos_cli_config_gen">eos_cli_config_gen</a></li>
<li>With <a href="https://docs.ansible.com/ansible/2.3/tower.html">Ansible Tower</a></li>
<li>With CI/CD</li>
<li>With <a href="../../roles/eos_config_deploy_cvp">eos_config_deploy_cvp</a> / <a href="../../roles/eos_config_deploy_eapi">eos_config_deploy_eapi</a></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 19, 2022</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019 - 2021 Arista Networks
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../stylesheets/tables.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
      
        <script src="../stylesheets/highlight.js"></script>
      
    
  </body>
</html>