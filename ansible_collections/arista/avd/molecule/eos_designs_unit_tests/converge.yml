---
- name: Converge
  hosts: EOS_DESIGNS_UNIT_TEST
  gather_facts: false
  connection: local
  tasks:

    - name: Generate intended variables
      delegate_to: 127.0.0.1
      ansible.builtin.import_role:
        name: arista.avd.eos_designs

- name: Converge Negative tests
  hosts: EOS_DESIGNS_FAILURES
  gather_facts: false
  connection: local
  tasks:
    - block:
        - name: Trigger Error
          ansible.builtin.import_role:
            name: arista.avd.eos_designs
      rescue:
        # Verify that the role failed and the error message is as we expect
        - ansible.builtin.assert:
            that:
              - ansible_failed_result is defined
              - ansible_failed_result.msg == expected_error_message
