{# eos - tx-queue profiles #}
   !
   tx-queue {{ tx_queue.id }}
{% if tx_queue.bandwidth_percent is arista.avd.defined %}
      bandwidth percent {{ tx_queue.bandwidth_percent }}
{% elif tx_queue.bandwidth_guaranteed_percent is arista.avd.defined %}
      bandwidth guaranteed percent {{ tx_queue.bandwidth_guaranteed_percent }}
{% endif %}
{% if tx_queue.priority is arista.avd.defined %}
      {{ tx_queue.priority }}
{% endif %}
{% if tx_queue.shape.rate is arista.avd.defined %}
      shape rate {{ tx_queue.shape.rate }}
{% endif %}
{% if tx_queue.random_detect is arista.avd.defined %}
{%     if tx_queue.random_detect.ecn.count is arista.avd.defined(True) %}
      random-detect ecn count
{%     endif %}
{%     if tx_queue.random_detect.ecn.threshold is arista.avd.defined %}
{%         set metric = tx_queue.random_detect.ecn.threshold.metric %}
{%         if tx_queue.random_detect.ecn.threshold.min is arista.avd.defined %}
{%             set min_threshold = " minimum-threshold " ~ tx_queue.random_detect.ecn.threshold.min ~ " " ~ metric  %}
{%         else %}
{%             set min_threshold = "" %}
{%         endif %}
{%         if tx_queue.random_detect.ecn.threshold.max is arista.avd.defined %}
{%             set max_threshold = " maximum-threshold " ~ tx_queue.random_detect.ecn.threshold.max ~ " " ~ metric %}
{%         else %}
{%             set max_threshold = "" %}
{%         endif %}
{%         if tx_queue.random_detect.ecn.threshold.max_probability is arista.avd.defined %}
{%             set max_probability = " max-mark-probability " ~ tx_queue.random_detect.ecn.threshold.max_probability %}
{%         else %}
{%             set max_probability = "" %}
{%         endif %}
{%         if tx_queue.random_detect.ecn.threshold.weight is arista.avd.defined %}
{%             set ecn_weight = " weight " ~ tx_queue.random_detect.ecn.threshold.weight %}
{%         else %}
{%             set ecn_weight = "" %}
{%         endif %}
      random-detect ecn{{ min_threshold }}{{ max_threshold }}{{ max_probability }}{{ ecn_weight }}
{%     endif %}
{% endif %}
