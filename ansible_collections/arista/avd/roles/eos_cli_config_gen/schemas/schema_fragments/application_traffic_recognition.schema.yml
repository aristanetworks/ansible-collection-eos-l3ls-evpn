# Copyright (c) 2023 Arista Networks, Inc.
# Use of this source code is governed by the Apache License 2.0
# that can be found in the LICENSE file.
# yaml-language-server: $schema=../../../../plugins/plugin_utils/schema/avd_meta_schema.json
# Line above is used by RedHat's YAML Schema vscode extension
# Use Ctrl + Space to get suggestions for every field. Autocomplete will pop up after typing 2 letters.
type: dict
keys:
  application_traffic_recognition:
    type: dict
    description: Application traffic recognition configuration.
    keys:
      categories:
        type: list
        description: List of categories.
        primary_key: name
        items:
          type: dict
          keys:
            name:
              type: str
              description: Category name.
            applications:
              type: list
              description: List of applications.
              items:
                type: dict
                keys:
                  name:
                    type: str
                    description: Application name.
                  service:
                    type: str
                    description: If no service is specified, all supported services of the application are considered.
                    valid_values: ["audio-video", "chat", "default", "file-transfer", "networking-protocols", "peer-to-peer", "software-update"]

      field_sets:
        type: dict
        keys:
          l4_ports:
            type: list
            primary_key: name
            description: L4 port field-set.
            items:
              type: dict
              keys:
                name:
                  type: str
                  description: L4 port field-set name.
                port_values:
                  type: list
                  items:
                    type: str
                    description: |-
                      Port values or range of port values.
                      Port values are between 0 and 65535.
                    pattern: "^\\d+(\\-\\d+)?$"
          ipv4_prefixes:
            type: list
            primary_key: name
            description: Ipv4 prefix field set.
            items:
              type: dict
              keys:
                name:
                  type: str
                  description: IPv4 prefix field-set name.
                prefix_values:
                  type: list
                  items:
                    type: str
                    description: IP prefix (ex- 1.2.3.0/24).
                    pattern: "^\\(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\/[0-9]{1,2}$"
      applications:
        type: dict
        keys:
          ipv4_applications:
            type: list
            description: List of user defined ipv4 applications.
            primary_key: name
            items:
              type: dict
              keys:
                name:
                  type: str
                  description: Application name.
                src_prefix_set_name:
                  type: str
                  description: Source prefix set name.
                dest_prefix_set_name:
                  type: str
                  description: Destination prefix set name.
                protocol:
                  type: str
                  description: Protocol name.
                src_port_set_name:
                  type: str
                  description: Source l4 port field set name.
                dest_port_set_name:
                  type: str
                  description: Destination l4 port field set name.
      application_profiles:
        type: list
        description: Group of applications.
        items:
          type: dict
          keys:
            name:
              type: str
              description: Application Profile name.
            applications:
              type: list
              description: List of applications part of the application profile.
              items:
                type: dict
                keys:
                  name:
                    type: str
                    description: Application Name.
                  service:
                    type: str
                    description: |-
                      Service Name.
                      Actual supported services for an application are subset of
                      mentioned valid values and is application dependent.
                    valid_values: ["audio-video", "chat", "default", "file-transfer", "networking-protocols", "peer-to-peer", "software-update"]
            transports:
              type: list
              description: List of transport protocols.
              items:
                type: str
                description: Transport name.
                valid_values: ["http", "https", "udp", "tcp", "ip", "ip6", "ssl", "rtp", "sctp", "quic"]
            categories:
              type: list
              description: Categories under this application profile.
              items:
                type: dict
                keys:
                  name:
                    type: str
                    description: Name of a category.
                  service:
                    type: str
                    description: |-
                      Service name.
                      Actual supported services for an application are subset of
                      mentioned valid values and is application dependent.
                    valid_values: ["audio-video", "chat", "default", "file-transfer", "networking-protocols", "peer-to-peer", "software-update"]
