# Copyright (c) 2024 Arista Networks, Inc.
# Use of this source code is governed by the Apache License 2.0
# that can be found in the LICENSE file.
# yaml-language-server: $schema=../../../../plugins/plugin_utils/schema/avd_meta_schema.json
# Line above is used by RedHat's YAML Schema vscode extension
# Use Ctrl + Space to get suggestions for every field. Autocomplete will pop up after typing 2 letters.
type: dict
keys:
  monitor_telemetry_postcard:
    type: dict
    keys:
      disabled:
        type: bool
        description: Enable or disable the postcard telemetry feature
      ingress:
        type: dict
        description: Configure ingress parameters
        keys:
          collection:
            type: dict
            description: Collector configuration
            keys:
              source:
                type: str
              destination:
                type: str
          sample:
            type: dict
            description: Configure sampling parameters
            keys:
              rate:
                type: int
                description: Configure sampling rate
                convert_types:
                - str
                valid_values: [ 16384, 32768, 65536 ]
              tcp_udp_checksum:
                type: int
                description: Configure TCP/UDP checksum or IP ID checksum
                convert_types:
                - str
      profile:
        type: dict
        description: Configure the postcard telemetry profile
        keys:
          name:
            type: str
          ingress_sample_policy:
            type: str
            description: Configure ingress parameters
      sample_policy:
        type: dict
        description: Configure sampling feature
        keys:
          name:
            type: str
          match_rule:
            type: dict
            keys:
              rule_name:
                type: str
              ipversion:
                type: str
                valid_values: [ ipv4, ipv6 ]
              destination_prefix:
                type: dict
                keys:
                  prefix_address:
                    type: str
                  prefix_mask:
                    type: int
                    convert_types:
                    - str
              source_prefix:
                type: dict
                keys:
                  prefix_address:
                    type: str
                  prefix_mask:
                    type: int
                    convert_types:
                    - str
              protocol:
                type: dict
                keys:
                  type_of_protocol:
                    type: str
                    valid_values: [ tcp, udp ]
                  destination_port:
                    type: str
                    description: |
                      Enter the port number or range or multiple port numbers with comma seperated values.
                      Examples:
                        "65-78"
                        "55"
                        "44, 55, 66"
